<div class="plan">
  <!-- Header with navigation and stadium info -->
  <app-plan-header
    [seatMap]="seatMap"
    [selectedSeatCount]="getSelectedSeatCount()"
    (backClicked)="onBackToStadiums()"
  ></app-plan-header>

  <!-- Loading state -->
  <div *ngIf="loading" class="plan__loading">
    <div class="plan__spinner"></div>
    <p>در حال بارگذاری نقشه صندلی‌ها...</p>
  </div>

  <!-- Error state -->
  <div *ngIf="error && !loading" class="plan__error">
    <p>{{ error }}</p>
    <app-button text="تلاش مجدد" variant="primary" size="medium" (clicked)="retry()"> </app-button>
  </div>

  <!-- Seat map visualization -->
  <div *ngIf="!loading && !error && seatMap" class="plan__seat-map">
    <!-- Seat table component -->
    <app-seat-table
      [seatMap]="seatMap"
      [selectedSeats]="selectedSeats"
      [disabled]="purchasing"
      (seatClick)="onSeatClick($event)"
    ></app-seat-table>

    <!-- Purchase messages -->
    <app-purchase-messages
      [successMessage]="purchaseSuccess"
      [errorMessage]="purchaseError"
      (dismissMessages)="onDismissPurchaseMessages()"
    ></app-purchase-messages>

    <!-- Selection summary and purchase -->
    <app-selection-summary
      [selectedSeats]="selectedSeats"
      [purchasing]="purchasing"
      (purchaseClicked)="onPurchaseSelectedSeats()"
      (clearSelectionClicked)="onClearSelection()"
    ></app-selection-summary>
  </div>

  <!-- Empty state -->
  <div *ngIf="!loading && !error && !seatMap" class="plan__empty-state">
    <p>نقشه‌ای یافت نشد</p>
    <app-button
      text="بازگشت به لیست سالن‌ها"
      variant="primary"
      size="medium"
      (clicked)="onBackToStadiums()"
    >
    </app-button>
  </div>
</div>
