<div class="plan">
  <!-- Header with navigation and stadium info -->
  <header class="plan-header">

    <div class="plan-header__stadium-info" *ngIf="seatMap">
      <h1 class="plan-header__stadium-name">{{ seatMap.name || 'نقشه سالن' }}</h1>
      <span class="plan-header__stadium-id">{{ seatMap.id }}</span>
    </div>
  </header>

  <!-- Map info -->
  <div class="plan-header__map-info" *ngIf="seatMap">
    <span>تعداد صندلی‌ها: {{ seatMap.rows * seatMap.columns }}</span>

    <div class="plan-header__legend">
      <div class="plan-header__legend-item">
        <div class="plan-header__legend-color plan-header__legend-color--available"></div>
        <span>آزاد</span>
      </div>
      <div class="plan-header__legend-item">
        <div class="plan-header__legend-color plan-header__legend-color--reserved"></div>
        <span>رزرو شده</span>
      </div>
      <div class="plan-header__legend-item">
        <div class="plan-header__legend-color plan-header__legend-color--selected"></div>
        <span>انتخاب شده</span>
      </div>
    </div>
  </div>

  <!-- Loading state -->
  <div *ngIf="loading" class="plan__loading">
    <div class="plan__spinner"></div>
    <p>در حال بارگذاری نقشه صندلی‌ها...</p>
  </div>

  <!-- Error state -->
  <div *ngIf="error && !loading" class="plan__error">
    <p>{{ error }}</p>
    <app-button text="تلاش مجدد" variant="primary" size="medium" (clicked)="retry()"> </app-button>
  </div>

  <!-- Seat map visualization -->
  <div *ngIf="!loading && !error && seatMap" class="plan__seat-map">
    <!-- Seat table component -->
    <app-seat-table
      [seatMap]="seatMap"
      [selectedSeats]="selectedSeats"
      [disabled]="purchasing"
      (seatClick)="onSeatClick($event)"
    ></app-seat-table>

    <!-- Selection summary and purchase -->
    <app-selection-summary
      [selectedSeats]="selectedSeats"
      [purchasing]="purchasing"
      (purchaseClicked)="onPurchaseSelectedSeats()"
      (clearSelectionClicked)="onClearSelection()"
    ></app-selection-summary>
  </div>

  <!-- Empty state -->
  <div *ngIf="!loading && !error && !seatMap" class="plan__empty-state">
    <p>نقشه‌ای یافت نشد</p>
  </div>

  <!-- Toast notifications -->
  <app-toast
    [toasts]="(toastService.toasts$ | async) || []"
    (dismissToast)="toastService.dismissToast($event)"
  ></app-toast>
</div>
